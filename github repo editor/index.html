<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>GitHub API</title>

	<!-- Import the Bootstrap CSS CDN -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

</head>
<body>

	<h3 class="text-center mt-5">GitHub API</h3>
	<form id="gitHubForm" class="form-inline mx-auto" style="width: 280px">
		<input id="usernameInput" class="form-control mb-5" type="text" name="username" placeholder="GitHub Username">
		<input type="submit" class="btn btn-primary ml-2 mb-5" value="Submit">
	</form>
	<ul id="userRepos" class="list-group mx-auto mb-5" style="width: 500px">

	</ul>
    <script type="text/javascript" charset="utf-8">
        
        // Get the GitHub username input form
        const gitHubForm = document.getElementById('gitHubForm');
        
        // Listen for submissions on GitHub username input form
        gitHubForm.addEventListener('submit', (e) => {
        
            // Prevent default form submission action
            e.preventDefault();
        
            // Get the GitHub username input field on the DOM
            let usernameInput = document.getElementById('usernameInput');
        
            // Get the value of the GitHub username input field
            let gitHubUsername = usernameInput.value;
        
            // Run GitHub API function, passing in the GitHub username
            requestUserRepos(gitHubUsername)
                // resolve promise then parse response into json
                .then(response => response.json())
                // resolve promise then iterate through json
                .then(data => {
                    // update html with data from github
                    for (let i in data) {
                        // Get the ul with id of userRepos
        
                        if (data.message === "Not Found") {
                            let ul = document.getElementById('userRepos');
        
                            // Create variable that will create li's to be added to ul
                            let li = document.createElement('li');
        
                            // Add Bootstrap list item class to each li
                            li.classList.add('list-group-item')
                            // Create the html markup for each li
                            li.innerHTML = (`
                        <p><strong>No account exists with username:</strong> ${gitHubUsername}</p>`);
                            // Append each li to the ul
                            ul.appendChild(li);
                        } else {
        
                            let ul = document.getElementById('userRepos');
        
                            // Create variable that will create li's to be added to ul
                            let li = document.createElement('li');
        
                            // Add Bootstrap list item class to each li
                            li.classList.add('list-group-item')
        
                            // Create the html markup for each li
                            li.innerHTML = (`
                        <div onclick="displayRepoContent(${data[i].name}, ${gitHubUsername})"><p><strong>Repo:</strong> ${data[i].name}</p>
                        <p><strong>Description:</strong> ${data[i].description}</p>
                        <p><strong>URL:</strong> <a>${data[i].html_url}</a></p></div>
                    `);
        
                            // Append each li to the ul
                            ul.appendChild(li);
                        }
                    }
                })
        })
        
        function requestUserRepos(username) {
            // create a variable to hold the `Promise` returned from `fetch`
            return Promise.resolve(fetch(`https://api.github.com/users/${username}/repos#blooket`));
        }

        function displayRepoContent(repository, user) {
            url = "https://api.github.com/repos/" + user + "/"  + repository + "/git/trees/main?recursive=1repository";
            alert(url)
            alert(fetch(url));
        }
        
    </script>
</body>